<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Google XSS Challenge :: T0XICITY — Wannabe h4x0r</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Google XSS Game In this post I solve the Goolge beginners XSS challanges. These are easier and especially recommended for beginners.
Level 1: Hello, world of XSS This entry-level task is a simple example of XSS. No matter which payload is placed where, it is executed.
Payload: // In the input field &amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt; //In the url frame?query=&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt; The code is integrated into the application without further verification, so that the browser understands and executes it as part of the page code."/>
<meta name="keywords" content="hacking, bash, linux, ctf"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://T0XICITY.com/blog/xss-game/" />





<link rel="stylesheet" href="https://T0XICITY.com/assets/style.css">


<link rel="stylesheet" href="https://T0XICITY.com/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://T0XICITY.com/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://T0XICITY.com/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Google XSS Challenge"/>
<meta name="twitter:description" content="Writeup of Googles beginner XSS-Game"/>



<meta property="og:title" content="Google XSS Challenge" />
<meta property="og:description" content="Writeup of Googles beginner XSS-Game" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://T0XICITY.com/blog/xss-game/" />
<meta property="article:published_time" content="2020-04-28T21:04:06+01:00" />
<meta property="article:modified_time" content="2020-04-28T21:04:06+01:00" /><meta property="og:site_name" content="T0XICITY" />





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-174271647-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-174271647-1');
</script>


  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">T0XICITY</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/blog">Blog</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/blog">Blog</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h2 class="post-title"><a href="https://T0XICITY.com/blog/xss-game/">Google XSS Challenge</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
          2020-04-28
        </span>

        
          
        
      

      <span class="post-author">— Written by Patrick</span>
      
    </div>

    

    
      
        <img src="https://T0XICITY.com/img/googleXSSCtf/googleXSSChallenge.jpg" class="post-cover" />
      
    

    <div class="post-content">
      <h1 id="google-xss-game">Google XSS Game</h1>
<p>In this post I solve the Goolge beginners XSS challanges. These are easier and especially recommended for beginners.</p>
<h2 id="level-1-hello-world-of-xss">Level 1: Hello, world of XSS</h2>
<p><img src="/img/googleXSSCtf/googleXXSCtf1.1.png" alt="Image Challange1.1"></p>
<p>This entry-level task is a simple example of XSS. No matter which payload is placed where, it is executed.</p>
<h4 id="payload">Payload:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">// In the input field
</span><span style="color:#75715e"></span>&lt;<span style="color:#a6e22e">script</span>&gt;<span style="color:#a6e22e">alert</span>(<span style="color:#ae81ff">0</span>)&lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">script</span>&gt;
<span style="color:#75715e">//In the url
</span><span style="color:#75715e"></span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">?</span><span style="color:#a6e22e">query</span>=&lt;<span style="color:#a6e22e">script</span>&gt;<span style="color:#a6e22e">alert</span>(<span style="color:#ae81ff">0</span>)&lt;<span style="color:#f92672">/</span><span style="color:#a6e22e">script</span>&gt;</code></pre></div>
<p>The code is integrated into the application without further verification, so that the browser understands and executes it as part of the page code.</p>
<h2 id="level-2-persistence-is-key">Level 2: Persistence is key</h2>
<p><img src="/img/googleXSSCtf/googleXSSCtf2.1.png" alt="Image Challange2.1"></p>
<p>This time there is a validation that prevents us from using the script tag. To work around this, we can insert an image tag with an invalid URL and an onerror attribute that triggers a javascript alert. I have also tested functions like onmouseover or onload, but they did not work here. Unlike the first task, our payload in this example is stored in the application so it is a stored XSS.</p>
<h4 id="payload-1">Payload:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">&lt;<span style="color:#a6e22e">img</span> <span style="color:#a6e22e">src</span>=<span style="color:#e6db74">&#39;x&#39;</span> <span style="color:#a6e22e">onerror</span>=<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">alert</span>(<span style="color:#ae81ff">0</span>)<span style="color:#960050;background-color:#1e0010">&#39;</span>&gt;</code></pre></div>
<p><img src="/img/googleXSSCtf/googleXSSCtf2.2.jpg" alt="Image Challange2.2"></p>
<h2 id="level-3-that-sinking-feeling">Level 3: That sinking Feeling…</h2>
<p><img src="/img/googleXSSCtf/googleXSSCtf3.1.png" alt="Image Challange3.1"></p>
<p>This application gives the user 3 images to choose from. Depending on which image the user selects, the number of images in the url changes.</p>
<p>My first step was to check what happens if i enter a number in the url that does not exist on the application for example #6.</p>
<p><img src="/img/googleXSSCtf/googleXSSCtf3.2.png" alt="Image Challange3.2"></p>
<p>My request is processed normally but no picture is displayed, because it is obviously not existent.</p>
<p>The next step was to test what happens when I type in known JavaScript escape characters like ' single quote or
&quot; double quote.</p>
<p><img src="/img/googleXSSCtf/googleXSSCtf3.3.jpg" alt="Image Challange3.3"></p>
<p>As it turned out it is possible to add additional commands by inserting single quotes.</p>
<p>Now only a suitable payload must be added.</p>
<h4 id="payload-2">Payload:</h4>
<p><img src="/img/googleXSSCtf/googleXSSCtf3.4.jpg" alt="Image Challange3.3"></p>
<h2 id="level-4-context-matters">Level 4: Context matters</h2>
<p><img src="/img/googleXSSCtf/googleXSSCtf4.1.png" alt="Image Challange4.1">
In this task we can pass a number to the page input which is passed to a timer function. The input is not checked, so special characters and letters can also be entered.</p>
<p>Adding a single qoutes leads to an error in the startTimer function.<br>
<img src="/img/googleXSSCtf/googleXSSCtf4.2.jpg" alt="Image Challange4.1"></p>
<p>If we now add a <strong>&quot;)&quot;</strong> the call looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">onload</span>=<span style="color:#e6db74">&#34;startTimer(&#39;3&#39;)&#39;);&#34;</span></code></pre></div>
<p>to create a valid statement and trigger an alert the following must be added:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#75715e">//Added part
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">&#39;</span>);<span style="color:#a6e22e">alert</span>(<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0</span>

<span style="color:#75715e">//Valid Statement
</span><span style="color:#75715e"></span><span style="color:#a6e22e">onload</span>=<span style="color:#e6db74">&#34;startTimer(&#39;3&#39;);alert(&#39;0&#39;);&#34;</span></code></pre></div>
<p>Our payload is now valid and is processed correctly.</p>
<h2 id="level-5-breaking-protocol">Level 5: Breaking protocol</h2>
<p><img src="/img/googleXSSCtf/googeXSSCtf5.1.png" alt="Image Challange5.1"></p>
<p>The welcome page does nothing special, it only leads us to the login page. On the login page, we can make any input and click on the next link.
<img src="/img/googleXSSCtf/googleXSSCtf5.2.jpg" alt="Image Challange5.2"></p>
<p>The next parameter is used to set the window.location. We can use this parameter to execute our Javascript function.</p>
<h4 id="payload-3">Payload:</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">https</span>:<span style="color:#f92672">//</span><span style="color:#a6e22e">xss</span><span style="color:#f92672">-</span><span style="color:#a6e22e">game</span>.<span style="color:#a6e22e">appspot</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">level5</span><span style="color:#f92672">/</span><span style="color:#a6e22e">frame</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signup</span><span style="color:#960050;background-color:#1e0010">?</span><span style="color:#a6e22e">next</span>=<span style="color:#a6e22e">javascript</span>:<span style="color:#a6e22e">alert</span>(<span style="color:#ae81ff">0</span>)</code></pre></div>
<h2 id="level-6-follow-the-">Level 6: Follow the 🐇</h2>
<p><img src="/img/googleXSSCtf/googleXSSCtf6.1.png" alt="Image Challange6.1"></p>
<p>For this task the description gives some good hints on how the application works.</p>
<p>The filter is configured to blacklist and thus prohibit access to &ldquo;remote&rdquo; content. In this case it should prohibit access to other remote servers by blacklisting https.
<img src="/img/googleXSSCtf/googleXSSCtf6.2.jpg" alt="Image Challange6.2">
the filter is easy to bypass because it is not case sensitive. In this case we can simply use Https, hTTps or httpS to execute our payload.</p>
<p>So we can trigger an alert function</p>
<p><img src="/img/googleXSSCtf/googleXSSCtf6.3.jpg" alt="Image Challange6.3"></p>

    </div>
    
      
    


    
      
        

      
    

    </div>

      </div>

      
        <footer class="footer">
    <div class="footer__inner">
        
        <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">T0XICITY</span>
    <span class="logo__cursor"></span>
  
</a>

        
    </div>
</footer>

<script src="https://T0XICITY.com/assets/main.js"></script>
<script src="https://T0XICITY.com/assets/prism.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div style="font-size: 2rem;">
<a style="text-decoration:none;" href="https://github.com/T0XICITY" target="_blank" rel="noopener" class="fa fa-github"></a>
<a style="text-decoration:none" href="https://twitter.com/t0xicity__"target="_blank" rel="noopener" class="fa fa-twitter"></a>
<a style="text-decoration:none" href="mailto:klingenbergpa95@gmail.com" target="_blank" rel="noopener" class="fa fa-envelope"></a>
</div>


<div class="copyright copyright--user">© 2020 Patrick Klingenberg </div>

<span ><a style="text-decoration:none" href="/privacy">Imprint / Contact / Privacy</a> </span>

<div style="font-size: 0.8rem;line-height: 2rem;">
    <span> Powered by <a style="text-decoration:none" href="https://gohugo.io" target="_blank" rel="noopener">Hugo | </a></span>
    <span>Theme created by <a style="text-decoration:none" href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span>
</div>
      
    </div>

    
  </body>
</html>
